{% extends 'base.html' %}
{% load static custom_tags %}
{% load bootstrap4 %}

{% block title %}
    My Progress - {{ request.user.username|capfirst }}
{% endblock %}

{% block extra_css %}
    {#    <script src="{% static 'js/plugins/Chart.js' %}"></script>#}
{% endblock %}


{% block main %}

    <div class="recipe-detail" style="padding: 0;width: 98%;">

        <div>

            <div class="row justify-content-center">
                <div class="col-lg-12 text-center">
                    <h1 class="no_font_weight">Overall Statistics</h1>
                </div>
            </div>

            {% if not user_pack %}
                <div class="row justify-content-center">
                    <div class="col-lg-12 text-center">
                        <h2>
                            You do not have any pack yet. Start adding Sessions from <a href="{% url 'discover' %}">Discover
                            page</a>.
                        </h2>
                    </div>
                </div>
            {% else %}

                <div class="row justify-content-center mb-5 mt-5">
                    <div class="col-lg-3 text-center">
                        <p>
                            Total hours spent
                        </p>
                        <h2>{{ profile.total_session_hours }}</h2>
                    </div>
                    <div class="col-lg-3 text-center">
                        <p>
                            Total number of Practices
                        </p>
                        <h2>{{ profile.total_repetitions }}</h2>
                    </div>
                    <div class="col-lg-3 text-center">
                        <p>
                            Overall Fulfillment
                        </p>
                        <h2>{{ profile.total_fulfillment }}</h2>
                        <small>out of 5</small>
                    </div>
                </div>

                <div class="row justify-content-center mb-5 mt-5">
                    <div class="col-lg-3 text-center">
                        <p>
                            My Progress<sup>*</sup> vs last week
                        </p>
                        <h2 class="text-{% if profile.weekly_progress|negative %}danger{% else %}success{% endif %} font-weight-bold">
                            {{ profile.weekly_progress }}%
                            <i class="fas fa-caret-{% if profile.weekly_progress|negative %}down{% else %}up{% endif %}"></i>
                        </h2>
                    </div>
                    <div class="col-lg-3 text-center">
                        <p>
                            My Progress<sup>*</sup> vs last month
                        </p>
                        <h2 class="text-{% if profile.monthly_progress|negative %}danger{% else %}success{% endif %} font-weight-bold">
                            {{ profile.monthly_progress }}%
                            <i class="fas fa-caret-{% if profile.monthly_progress|negative %}down{% else %}up{% endif %}"></i>
                        </h2>
                    </div>
                    <div class="col-lg-3 text-center">
                        <p>
                            My Progress<sup>*</sup> vs last year
                        </p>
                        <h2 class="text-{% if profile.annual_progress|negative %}danger{% else %}success{% endif %} font-weight-bold">
                            {{ profile.annual_progress }}%
                            <i class="fas fa-caret-{% if profile.annual_progress|negative %}down{% else %}up{% endif %}"></i>
                        </h2>
                    </div>
                </div>

                <div class="row justify-content-center mb-5 mt-5">
                    <div class="col-lg-10 text-left">
                        <small>
                            <sup>*</sup> Progress = hours spent + number of practices done + fulfilment rate
                        </small>
                    </div>
                </div>

            {% endif %}


            {% if user_pack %}
                <hr>
                <div class="row justify-content-center">
                    <div class="col-lg-5 text-center">
                        <h2>How am I doing this year?</h2>
                        <a href="{% url 'practice_tracker_yearly' %}">
                            <button class="btn btn-dark_lila" style="cursor: pointer;">Annual Investment Total</button>
                        </a>

                    </div>

                    {#                <div class="col-lg-10 mt-4 mb-4">#}
                    {#                    <h2 class="thin_text text-center">#}
                    {#                        Total hours spent per month#}
                    {#                    </h2>#}
                    {#                    <canvas id="total_hours"></canvas>#}
                    {#                </div>#}
                    {##}
                    {#                <div class="col-lg-10 mt-5 mb-4">#}
                    {#                    <h2 class="thin_text text-center">#}
                    {#                        Total number of practices per month#}
                    {#                    </h2>#}
                    {#                    <canvas id="number_practices"></canvas>#}
                    {#                </div>#}
                    {##}
                    {#                <div class="col-lg-10 mt-5">#}
                    {#                    <h2 class="thin_text text-center">#}
                    {#                        My fulfilment per month#}
                    {#                    </h2>#}
                    {#                    <canvas id="fulfilment"></canvas>#}
                    {#                </div>#}

                </div>
                <div class="col-lg-12 reduce-padding">
                    {% include "user/practice_tracker_yearly.html" with user_data=user_data year=year extends_template=extends_template myprogress='True' only %}
                </div>
            {% endif %}

        </div>
    </div>

{% endblock %}


{% block extra_js %}
    <script>
        window.total_hours = {{ total_hours }};
        window.total_practices = {{ total_practices }};
        window.average_fulfilments = {{ average_fulfilments }};
    </script>
    {#    <script type="text/javascript" src="{% static 'js/stats/total_hours.js' %}"></script>#}
    {#    <script type="text/javascript" src="{% static 'js/stats/number_practices.js' %}"></script>#}
    {#    <script type="text/javascript" src="{% static 'js/stats/fulfilment.js' %}"></script>#}
    {#    <script type="text/javascript" src="{% static 'js/stats/init_graphs.js' %}"></script>#}
{% endblock %}